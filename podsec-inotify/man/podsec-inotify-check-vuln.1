.\" generated with Ronn/v0.7.3
.\" http://github.com/rtomayko/ronn/tree/0.7.3
.
.TH "PODSEC\-INOTIFY\-CHECK\-VULN" "1" "June 2023" "" ""
.
.SH "NAME"
\fBpodsec\-inotify\-check\-vuln\fR \- скрипт мониторинга docker\-образов узла сканером безопасности trivy
.
.SH "SYNOPSIS"
\fBpodsec\-inotify\-check\-vuln\fR
.
.SH "DESCRIPTION"
Для корректной работы скрипта необходимо запустить сервис \fBpodsec\-inotify\-server\-trivy\fR: \fBsystemctl enable \-\-now podsec\-inotify\-server\-trivy\fR
.
.P
Скрипт производит мониторинг \fBdocker\-образов\fR узла сканером безопасности \fBtrivy\fR:
.
.IP "\(bu" 4
Если скрипт запускается от имени пользователя \fBroot\fR скрипт:
.
.IP "\(bu" 4
проверяет сканером \fBtrivy\fR \fBrootfull\fR образы;
.
.IP "\(bu" 4
для всех пользователей каталога \fB/home/\fR проверяется наличие \fBrootless\fR\-образов\. При их наличии проверяет сканером \fBtrivy\fR эти образы\.
.
.IP "" 0

.
.IP "\(bu" 4
Если скрипт запускается от имени обычного пользователя проверяется наличие \fBrootless\fR\-образов\. При их наличии проверяет сканером \fBtrivy\fR эти образы\.
.
.IP "" 0
.
.P
Результат анализа посылается в системный лог\. Если при анализе образа число обнаруженных угроз уровня \fBHIGH\fR больше 0, результат посылается почтой системному администратору (\fBroot\fR)\.
.
.SH "OPTIONS"
Отсутствуют\.
.
.P
В состав пакета кроме этого скрипта входит файл для \fBcron\fR \fB/etc/podsec/crontabs/podsec\-inotify\-check\-vuln\fR\. Файл содержит единственную строку с описанием режима запуска скрипта \fBpodsec\-inotify\-check\-vuln\fR\. Во время установки пакета строка файла (в случае ее отсутствия) дописыватся в \fBcrontab\fR\-файл \fB/var/spool/cron/root\fR пользователя \fBroot\fR\.
.
.P
Если необходимо изменить режим запуска скрипта или выключить его это можно сделать командой редактирования \fBcrontab\fR\-файла:
.
.IP "" 4
.
.nf


#  crontab \-e
.
.fi
.
.IP "" 0
.
.SH "EXAMPLES"
\fBpodsec\-inotify\-check\-vuln\fR
.
.SH "SECURITY CONSIDERATIONS"
\-
.
.SH "SEE ALSO"
The all\-in\-one open source security scanner \fIhttps://trivy\.dev/\fR
.
.SH "AUTHOR"
Костарев Алексей, Базальт СПО kaf@basealt\.ru
